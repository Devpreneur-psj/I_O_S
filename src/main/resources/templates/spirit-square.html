<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>정령 광장 - SOI</title>
    <link rel="stylesheet" th:href="@{/css/spirit-square.css?v=2}">
    <link rel="stylesheet" th:href="@{/css/modal.css}">
</head>
<body>
    <div class="spirit-square-container">
        <!-- 배경 -->
        <div class="background-layer">
            <div class="background-image"></div>
        </div>


        <!-- 대표 정령 선택 모달 -->
        <div id="spiritSelectModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>대표 정령 선택</h2>
                <p>광장에서 사용할 정령을 선택하세요.</p>
                <div class="spirit-list" id="spiritList">
                    <!-- 정령 목록이 여기에 동적으로 추가됩니다 -->
                </div>
            </div>
        </div>

        <!-- 교환 모달 -->
        <div id="tradeModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeTradeModal()">&times;</span>
                <h2>교환</h2>
                <div class="trade-content" id="tradeContent">
                    <!-- 교환 내용이 여기에 표시됩니다 -->
                </div>
            </div>
        </div>

        <!-- 메인 콘텐츠 -->
        <div class="content-wrapper">
            <!-- 상단 헤더 -->
            <div class="square-header">
                <h1 class="title">💛 정령 광장</h1>
                <div class="header-controls">
                    <span class="current-users" id="currentUsers">온라인: 0명</span>
                    <button class="btn-exit" onclick="exitSquare()">나가기</button>
                </div>
            </div>

            <!-- 광장 영역 -->
            <div class="square-area" id="squareArea">
                <!-- 다른 유저들의 정령들이 여기에 동적으로 표시됩니다 -->
            </div>

            <!-- 좌측 하단 채팅 영역 -->
            <div class="chat-container">
                <div class="chat-header">
                    <span>💬 채팅</span>
                    <button class="btn-toggle-chat" onclick="toggleChatMode()">이동 모드</button>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <!-- 채팅 메시지들이 여기에 표시됩니다 -->
                </div>
                <div class="chat-input-container" id="chatInputContainer">
                    <input type="text" id="chatInput" placeholder="정령을 선택한 후 채팅할 수 있습니다" 
                           disabled>
                    <button onclick="sendMessage()">전송</button>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/js/modal.js}"></script>
    <script th:src="@{/js/modal-draggable.js}"></script>
    <script th:src="@{/js/spirit-square-websocket.js}"></script>
    <script th:src="@{/js/spirit-square.js?v=6}"></script>
</body>
</html>

